extends main-layout

mixin widget(name, header, pageinfo)
	.widget(class=name)
		h2(class="header")= header
		div(class="content")= pageinfo

mixin spot_widget(data)
	.feed(name='feed').well
		a.btn.btn-info(href='/main/spots/edit/' + data.objectId) Modify Spot
		&nbsp;
		a.btn.btn-warning(href='/main/spots/subscribe/' + data.objectId) Subscribe
		h3.header= data.name
		.warning
			h5 Warnings: 
				= data.warning
		.condition
			h5 Condition: 
				= data.condition
		.description
			p= data.description
		.distance
			h5 Distance from you: 0 Miles
		.score
			if (data.rating == "awesome") 
				.threestars
			if (data.rating == "solid") 
				.twostars
			if (data.rating == "good") 
				.onestars
		p
		.details
			p.date Last Updated #{dateNow(data.updatedAt)}

block content
	.container-fluid.fixed-top.stretched-topbar.topbar
		.row-fluid
			.span12
				.row-fluid
					.span1.hidden-phone
					.span5
						h2.head_title 
							=title
					.span5.pull-right.nav-location
						include includes/navigation2
					.span1.hidden-phone
	.container.middlebar
		.row
			.span12.top_spacer.hidden-phone
	.container-fluid.bottom-bar.stretch
		.row-fluid
			.span1
			.span10
				.row-fluid
					div#map-canvas.fill
				.row-fluid
					.span12
						.well
							| [ soon to be list of items]
	.container-fluid.footer
		.row-fluid
			.span12.footer-bar
				include includes/footer

block script_include
	link(href='/css/spot.css', rel='stylesheet')
	script(src='/js/lib/handlebars.js', type='text/javaScript')
	script(type='text/javascript')
		window._$spot_url = '#{spot_url}';
		window._$userId = '#{user_id}';
		window._$session_id = '#{session_id}';
		window._$local['mapzoom'] = 6;
	script(type='text/javascript', src='//maps.googleapis.com/maps/api/js?key=#{google_api_key}&sensor=true')

block scripts
	script(type='text/x-handlebars-template', id='spots-error-template')
		.well.alert
			h3 Oops, it seems there was an error loading this section. Please sit tight while we try and reload the section in a few moments.
	script(type='text/x-handlebars-template', id='spots-old-template')
		{{#each results}}
		{{#if spotId}}
		.feed.well
			{{#ifCond belongsTo '#{session_id}'}}
			a.btn.btn-info(href='/main/spots/edit/{{spotId}}') Modify Spot
			&nbsp;
			{{/ifCond}}
			a.btn.btn-warning(action='/subscribe/spot/{{spotId}}', data-attr='{{spotId}}', method='PUT').subscribe Subscribe
			h3.header {{ name }}
			.wind_directions
				h5 Wind: 
					{{ wind_directions }}
			.geo_lat
				h5 Geo Location: 
					{{ location.latitude }}, {{ location.longitude }}
			.description
				p {{ description }}
			.distance
				h5 Distance from you: 0 Miles
			.score
				{{#ifCond rating "awesome"}}
				div.threestars
				{{/ifCond}}
				{{#ifCond rating "solid"}}
				div.twostars
				{{/ifCond}}
				{{#ifCond rating "good"}}
				div.onestars
				{{/ifCond}}
			p
			.details
				p.date Last Updated Empty
		{{/if}}
		{{/each}}
